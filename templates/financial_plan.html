{% extends "base.html" %}
{% block title %}Financial Plan - {{ msgid['title'] }}{% endblock %}


{% block body %}

    <section id="about" class="about">
        <div class="container" data-aos="fade-up">

            <div class="section-header">
                <h2>Admin</h2>
                <p>Financial Plan</p>
            </div>
            <div class="row gy-4">
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"></path>
                        </symbol>
                    </svg>
                    {% with messages = get_flashed_messages() %}
                        {% if messages %}
                            {% for message in messages %}
                                <div class="alert alert-warning d-flex align-items-center alert-dismissible fade show"
                                     role="alert">
                                    <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img"
                                         aria-label="Info:">
                                        <use xlink:href="#info-fill"></use>
                                    </svg>
                                    <div> {{ message }}
                                        <button type="button" class="btn-close" data-bs-dismiss="alert"
                                                aria-label="Close"></button>
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}
                    {% endwith %}
                </div>
                <h3>SALES REGISTRATION</h3>
                <button class="btn btn-warning" data-bs-toggle="modal"
                        data-bs-target="#addFinancialReportSimplified"
                        type="button">ADD SIMPLIFIED FINANCIAL REPORT
                </button>
                <button class="btn btn-warning" data-bs-toggle="modal"
                        data-bs-target="#addFinancialReport"
                        type="button">ADD FINANCIAL REPORT
                </button>
                <button class="btn btn-warning" data-bs-toggle="modal"
                        data-bs-target="#addLossReport"
                        type="button">ADD LOSS REPORT
                </button>
                <h3>PROFIT/INCOME SIMULATOR</h3>
                <p class="number-format">Minimum investment cost: {{ data['total']['minimum'] }}</p>
                <p class="number-format">Maximum investment cost: {{ data['total']['maximum'] }}</p>
                <p>Turnover (all sold products): <span id="total-turnover"></span></p>
                <p>Turnover after VAT deduction: <span class="total-turnover-after-vat"></span> (Total VAT = <span
                        id="total-vat"></span>)</p>
                <p>Variable costs: <span class="total-variable-costs"></span></p>
                <p>Fixed costs per month: <span class="number-format"> <span
                        id="fixedCostTotal">{{ data['total']['total_cost'] }}</span></span></p>
                <p>Net profit: <span id="net-profit"></span> >> (<span class="total-turnover-after-vat"> </span> -
                    (<span class="total-variable-costs"> </span> + <span
                            class="number-format"> {{ data['total']['total_cost'] }}</span>))</p>
                <p><strong>Net profit After Corporate Tax: <span id="net-profit-after-tax"></span></strong> (-11%) <br>
                    >>>
                    money that goes to our pocket after everyone did 냠냠냠</p>


                <hr>
                <h4>BREAK EVEN CHART</h4>
                {#                <div>#}
                {#                    <canvas id="myChart"></canvas>#}
                {#                </div>#}
                <h6>Margin after variable cost (breakeven) = money leftover to pay fixed costs. If I exceed the fixed
                    costs, I make profit, if not I lose</h6>
                <div class="overflow-scroll max-height-table">
                    <table class="table table-striped table-hover table-warning" id="break-even-table">
                        <thead>
                        <tr class="table-secondary table-bordered">
                            <th scope="col" colspan="1"></th>
                            <th scope="col" colspan="6">PER PRODUCT</th>
                            <th scope="col" colspan="5" style="border-left: black solid 3px">TOTAL</th>
                        </tr>
                        <tr>
                            <th scope="col">Product</th>
                            <th scope="col">Amount</th>
                            <th scope="col">Selling price / product</th>
                            <th scope="col">VAT</th>
                            <th scope="col">Price/product after VAT</th>
                            <th scope="col">Variable Cost</th>
                            <th scope="col">Margin after Var. Cost (breakeven)</th>
                            <th scope="col" style="border-left: black solid 3px">Selling price * units
                                (turnover/product)
                            </th>
                            <th scope="col">VAT</th>
                            <th scope="col">Price/product after VAT</th>
                            <th scope="col">Variable Cost</th>
                            <th scope="col">Margin after Var. Cost (breakeven)</th>

                        </tr>
                        </thead>
                        <tbody>

                        {% for product in data['products'] %}
                            {% if product[7] %}
                                <tr class="product-row">
                                    <td>{{ product[2] }}</td>
                                    <td><input type="number" aria-label="{{ product[2] }}"
                                               class="form-control unit-product"
                                               id="breakevenInput{{ loop.index0 }}"
                                               value="{{ product[19] }}"
                                               style="width: 200px">
                                    </td>
                                    <td class="turnover-total">{{ product[12] }}</td>
                                    <td>-{{ data['vat'][product[0]] }}</td>
                                    <td>=<span
                                            class="turnover-after-vat">{{ data['turnover-after-vat'][product[0]] }}</span>
                                    </td>
                                    <td>-<span class="variable-costs">{{ data['variable-costs'][product[0]] }}</span>
                                    </td>
                                    <td>=<span
                                            class="breakeven-per-product">{{ data['breakeven-per-product'][product[0]] }}</span>
                                    </td>
                                    <td style="border-left: black solid 3px"><span class="turnover-per-product"></span>
                                    </td>
                                    <td>-<span class="subtotal-vat"></span></td>
                                    <td>=<span class="turnover-per-product-after-vat"></span></td>
                                    <td>-<span class="subtotal-variable-costs"></span></td>
                                    <td>=<span class="turnover-per-product-after-varcost"></span></td>

                                </tr>
                            {% endif %}
                        {% endfor %}
                        </tbody>
                    </table>
                </div>

                <hr>
                <h4>SALES PER MONTH</h4>
                <div class="overflow-scroll max-height-table">
                    <table class="table  table-striped table-hover">
                        <thead>
                        <tr class="keep-all">
                            <th scope="col">Month</th>
                            <th scope="col">Total Turnover</th>
                            <th scope="col">VAT</th>
                            <th scope="col">Fixed Costs</th>
                            <th scope="col">Variable Costs</th>
                            <th scope="col">Breakeven</th>
                        </tr>
                        </thead>
                        <tbody>

                        {% for month in data['sales_month_summary'] %}
                            <tr class="table-success">
                                <th>{{ month }}</th>
                                <th class="number-format">{{ data['sales_month_summary'][month]['Total Turnover'] }}</th>
                                <th class="number-format">{{ data['sales_month_summary'][month]['VAT'] }}</th>
                                <th class="number-format">{{ data['total']['total_cost'] }}</th>
                                <th class="number-format">{{ data['sales_month_summary'][month]['Variable Costs'] }}</th>
                                <th class="number-format"
                                    id="break-even-per-month">{{ data['sales_month_summary'][month]['Break Even'] }}</th>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <h4>SALES PER DAY</h4>
                <div class="overflow-scroll max-height-table">
                    <table class="table  table-striped table-hover">
                        <thead>
                        <tr class="keep-all">
                            <th scope="col"></th>
                            <th scope="col"></th>
                            <th scope="col">Date</th>
                            <th scope="col">Total Turnover</th>
                            <th scope="col">VAT</th>
                            <th scope="col">Variable Costs</th>
                            <th scope="col">Margin</th>
                        </tr>
                        </thead>
                        <tbody>

                        {% for sale_date in data['sales_summary'] %}
                            <tr class="table-success">
                                <th>
                                    <button class="btn btn-success" data-bs-toggle="modal"
                                            data-bs-target="#editModalSale{{ sale_date }}"
                                            type="button"><i class="bi bi-pencil"></i></button>
                                </th>
                                <th>
                                    <button class="btn btn-danger" type="button"
                                            data-bs-toggle="modal"
                                            data-bs-target="#deleteModalSaleSummary{{ sale_date }}">
                                        <i class="bi bi-trash-fill"></i>
                                    </button>
                                </th>
                                <th>{{ sale_date }}</th>
                                <th class="number-format">{{ data['sales_summary'][sale_date]['Total Turnover'] }}</th>
                                <th class="number-format">{{ data['sales_summary'][sale_date]['VAT'] }}</th>
                                <th class="number-format">{{ data['sales_summary'][sale_date]['Variable Costs'] }}</th>
                                <th class="number-format">{{ data['sales_summary'][sale_date]['Break Even'] }}</th>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>

                <hr>
                <h4>대차대조표</h4>
                <div class="overflow-scroll max-height-table">

                    <table class="table  table-striped table-hover">
                        <thead>
                        <tr class="keep-all">
                            <th scope="col"></th>
                            <th scope="col"></th>
                            <th scope="col">Asset</th>
                            <th scope="col">자산</th>
                            <th scope="col">최저 가격</th>
                            <th scope="col">최고 가격</th>
                            <th scope="col">ID</th>
                        </tr>
                        </thead>
                        <tbody>

                        {% for row in data['investments'] %}
                            <tr class="table-success">
                                <th>
                                    <button class="btn btn-success" data-bs-toggle="modal"
                                            data-bs-target="#investment_modal_{{ row [0] }}"
                                            type="button"><i class="bi bi-pencil"></i></button>
                                </th>
                                <th>
                                    <button class="btn btn-danger" type="button"
                                            data-bs-toggle="modal" data-bs-target="#deleteModalInvestment{{ row[0] }}">
                                        <i class="bi bi-trash-fill"></i>
                                    </button>
                                </th>
                                <th>{{ row[1] }}</th>
                                <th class="keep-all">{{ row[2] }}</th>
                                <th class="number-format text-end">{{ row[3] }}</th>
                                <th class="number-format text-end">{{ row[4] }}</th>
                                <th>{{ row[0] }}</th>

                            </tr>
                        {% endfor %}
                        <tr>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th class="number-format">{{ data['total']['minimum'] }}</th>
                            <th class="number-format">{{ data['total']['maximum'] }}</th>

                        </tr>
                        </tbody>
                    </table>
                </div>
                <button class="btn btn-success" data-bs-toggle="modal"
                        data-bs-target="#investment_modal_add"
                        type="button">ADD INVESTMENT
                </button>

                <div class="overflow-scroll max-height-table">

                    <table class="table  table-striped table-hover">
                        <thead>
                        <tr>
                            <th class="table-warning" scope="col" colspan="2">부채/자본</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <th class="table-warning"></th>
                            <td class="table-warning"></td>
                        </tr>
                        <tr>
                            <th></th>
                            <th></th>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <hr>
                <h4>목표원가계산</h4>
                <div class="overflow-scroll max-height-table">

                    <table class="table table-striped table-hover">
                        <thead>
                        <tr class="keep-all">
                            <th></th>
                            <th></th>
                            <th scope="col">영어</th>
                            <th scope="col">한국어</th>
                            <th scope="col">투자금액</th>
                            <th scope="col">일시불</th>
                            <th scope="col">개월/년</th>
                            <th scope="col">ID</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for row in data['fixed_costs'] %}
                            <tr class="table-success">
                                <th>
                                    <button class="btn btn-success" data-bs-toggle="modal"
                                            data-bs-target="#fixed_cost_modal_{{ row [0] }}"
                                            type="button"><i class="bi bi-pencil"></i></button>
                                </th>
                                <th>

                                    <button class="btn btn-danger" type="button"
                                            data-bs-toggle="modal" data-bs-target="#deleteModalFixedCost{{ row[0] }}">
                                        <i class="bi bi-trash-fill"></i>
                                    </button>
                                </th>
                                <th>{{ row[1] }}</th>
                                <th class="keep-all">{{ row[2] }}</th>
                                <th class="number-format text-end">{{ row[3] }}</th>
                                <th>{{ row[4] }}</th>
                                <th>{{ row[5] }}</th>
                                <th>{{ row[0] }}</th>

                            </tr>
                        {% endfor %}
                        <tr>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th class="number-format">{{ data['total']['total_cost'] }}</th>
                            <th></th>
                            <th></th>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <button class="btn btn-success" data-bs-toggle="modal"
                        data-bs-target="#fixed_cost_modal_add"
                        type="button">ADD FIXED COST
                </button>
                <button class="btn btn-success" data-bs-toggle="modal"
                        data-bs-target="#fixed_cost_modal_report"
                        type="button">REPORT MONTHLY FIXED COSTS
                </button>

            </div>

        </div>
    </section><!-- End About Us Section -->
    {% for row in data['investments'] %}
        <div class="modal fade" id="investment_modal_{{ row [0] }}" tabindex="-1" role="dialog"
             aria-labelledby="investmentModalLabel{{ row[0] }}"
             aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="investmentModalLabel{{ row[0] }}">{{ row [1] }} / {{ row [2] }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <form method="post" action="/financial_plan">
                        <div class="modal-body">
                            <div class="mb-3">
                                <label for="inputEnglish{{ row[0] }}" class="form-label">English Name</label>
                                <input type="text" class="form-control" id="inputEnglish{{ row[0] }}" name="english"
                                       value="{{ row[1] }}">
                            </div>
                            <div class="mb-3">
                                <label for="inputKorean{{ row[0] }}" class="form-label">Korean Name</label>
                                <input type="text" class="form-control" id="inputKorean{{ row[0] }}" name="korean"
                                       value="{{ row[2] }}">

                            </div>
                            <div class="mb-3">
                                <label for="inputMinimumCost{{ row[0] }}" class="form-label">Minimum Cost</label>
                                <input type="text" class="form-control" id="inputMinimumCost{{ row[0] }}"
                                       name="min_price" value="{{ row[3] }}">

                            </div>
                            <div class="mb-3">
                                <label for="inputMaximumCost{{ row[0] }}" class="form-label">Maximum Cost</label>
                                <input type="text" class="form-control" id="inputMaximumCost{{ row[0] }}"
                                       name="max_price" value="{{ row[4] }}">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary" name="investment_edit_button"
                                    value="{{ row[0] }}">Save changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    {% endfor %}

    {% for row in data['fixed_costs'] %}
        <div class="modal fade" id="fixed_cost_modal_{{ row [0] }}" tabindex="-1" role="dialog"
             aria-labelledby="fixedCostModalLabel{{ row[0] }}"
             aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="fixedCostModalLabel{{ row[0] }}">{{ row [1] }} / {{ row [2] }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <form method="post" action="/financial_plan">
                        <div class="modal-body">
                            <div class="mb-3">
                                <label for="inputEnglish{{ row[0] }}" class="form-label">English Name</label>
                                <input type="text" class="form-control" id="inputEnglish{{ row[0] }}" name="english"
                                       value="{{ row[1] }}">
                            </div>
                            <div class="mb-3">
                                <label for="inputKorean{{ row[0] }}" class="form-label">Korean Name</label>
                                <input type="text" class="form-control" id="inputKorean{{ row[0] }}" name="korean"
                                       value="{{ row[2] }}">

                            </div>
                            <div class="mb-3">
                                <label for="inputCostMonth{{ row[0] }}" class="form-label">Cost per month</label>
                                <input type="text" class="form-control" id="inputCostMonth{{ row[0] }}"
                                       name="cost_per_month" value="{{ row[3] }}">

                            </div>
                            <div class="mb-3">
                                <label for="inputOneTimeCost{{ row[0] }}" class="form-label">One-time cost</label>
                                <input type="text" class="form-control" id="inputOneTimeCost{{ row[0] }}"
                                       name="one_time_cost" value="{{ row[4] }}">

                            </div>
                            <div class="mb-3">
                                <label for="inputPeriod{{ row[0] }}" class="form-label">Months Per Year</label>
                                <input type="text" class="form-control" id="inputPeriod{{ row[0] }}" name="period"
                                       value="{{ row[5] }}">

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary" name="fixed_cost_edit_button"
                                    value="{{ row[0] }}">Save changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    {% endfor %}

    <div class="modal fade" id="fixed_cost_modal_report" tabindex="-1" role="dialog"
         aria-labelledby="fixedCostReportModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="fixedCostReportModalLabel">REPORT MONTHLY COSTS</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form method="post" action="/financial_plan">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="fixedCostReportModalDate" class="form-label">DATE</label>
                            <input type="date" class="form-control" id="fixedCostReportModalDate" name="date">
                        </div>
                        {% for row in data['fixed_costs'] %}
                            <div class="mb-3">
                                <label for="inputCostMonth{{ row[0] }}" class="form-label">{{ row[1] }}
                                    / {{ row[2] }}</label>
                                <input type="text" class="form-control" id="inputCostMonth{{ row[0] }}"
                                       name="cost_per_month$$${{ row[0] }}" value="{{ row[3] }}">
                            </div>
                        {% endfor %}
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary" name="fixed_cost_report_button">Save changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    {% for row in data['investments'] %}
        <div class="modal fade" id="deleteModalInvestment{{ row[0] }}" tabindex="-1"
             aria-labelledby="deleteModalInvestmentLabel{{ row[0] }}"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalInvestmentLabel{{ row[0] }}">
                            DELETE {{ row[0] }}: {{ row[1] }}?</h5>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancal</button>
                        <form action="/financial_plan" method="post">
                            <button class="btn btn-danger" name="btn_delete_investment" value="{{ row[0] }}"
                                    type="submit"><i class="bi bi-trash-fill"></i>DELETE
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
    {% for row in data['fixed_costs'] %}
        <div class="modal fade" id="deleteModalFixedCost{{ row[0] }}" tabindex="-1"
             aria-labelledby="deleteModalFixedCostLabel{{ row[0] }}"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalFixedCostLabel{{ row[0] }}">
                            DELETE {{ row[0] }}: {{ row[1] }}?</h5>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancal</button>
                        <form action="/financial_plan" method="post">
                            <button class="btn btn-danger" name="btn_delete_fixed_cost" value="{{ row[0] }}"
                                    type="submit"><i class="bi bi-trash-fill"></i>DELETE
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}

    <div class="modal fade" id="investment_modal_add" tabindex="-1" role="dialog"
         aria-labelledby="investmentModalLabelAdd"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="investmentModalLabelAdd"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form method="post" action="/financial_plan">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="inputEnglish" class="form-label">English Name</label>
                            <input type="text" class="form-control" id="inputEnglish" name="english"
                                   value="">
                        </div>
                        <div class="mb-3">
                            <label for="inputKorean" class="form-label">Korean Name</label>
                            <input type="text" class="form-control" id="inputKorean" name="korean"
                                   value="">

                        </div>
                        <div class="mb-3">
                            <label for="inputMinimumCost" class="form-label">Minimum Cost</label>
                            <input type="text" class="form-control" id="inputMinimumCost"
                                   name="min_price" value="">

                        </div>
                        <div class="mb-3">
                            <label for="inputMaximumCost" class="form-label">Maximum Cost</label>
                            <input type="text" class="form-control" id="inputMaximumCost"
                                   name="max_price" value="">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary" name="investment_add_button"
                                value="">ADD INVESTMENT
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal fade" id="fixed_cost_modal_add" tabindex="-1" role="dialog"
         aria-labelledby="fixedCostModalLabelAdd"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="fixedCostModalLabelAdd"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form method="post" action="/financial_plan">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="inputEnglish" class="form-label">English Name</label>
                            <input type="text" class="form-control" id="inputEnglish" name="english"
                                   value="">
                        </div>
                        <div class="mb-3">
                            <label for="inputKorean" class="form-label">Korean Name</label>
                            <input type="text" class="form-control" id="inputKorean" name="korean"
                                   value="">

                        </div>
                        <div class="mb-3">
                            <label for="inputCostMonth" class="form-label">Cost per month</label>
                            <input type="text" class="form-control" id="inputCostMonth"
                                   name="cost_per_month" value="">

                        </div>
                        <div class="mb-3">
                            <label for="inputOneTimeCost" class="form-label">One-time cost</label>
                            <input type="text" class="form-control" id="inputOneTimeCost"
                                   name="one_time_cost" value="">

                        </div>
                        <div class="mb-3">
                            <label for="inputPeriod" class="form-label">Months Per Year</label>
                            <input type="text" class="form-control" id="inputPeriod" name="period"
                                   value="">

                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary" name="fixed_cost_add_button"
                                value="">ADD FIXED COST
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="modal fade" id="addFinancialReport" tabindex="-1"
         aria-labelledby="addFinancialReportLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addFinancialReportLabel">Add Sales</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"></span>
                    </button>
                </div>
                <form method="post" action="/financial_plan">
                    <div class="modal-body">
                        <button class="btn btn-warning" id="period-toggle-sales-btn" type="button">MONTH</button>
                        <label for="date_sales" class="form-label">Date</label>
                        <input type="date" class="form-control" id="date_sales" name="date">
                        <div class="row">
                            <div class="col">제품</div>
                            <div class="col">LA</div>
                            <div class="col">LP</div>
                            <div class="col">MA</div>
                            <div class="col">MP</div>
                            <div class="col">HA</div>
                            <div class="col">HP</div>
                        </div>
                        <div class="sale-toggle-table">
                            {% for product in data['products'] %}
                                {% if product[7] %}
                                    <div class="row">
                                        <div class="col">
                                            <span>{{ product[1] }}</span>
                                            <input class="form-control" name="{{ product[0] }}" aria-label="" hidden>
                                        </div>
                                        <div class="col">
                                            <input type="number" class="form-control period-toggle-sales"
                                                   name="amount_low_{{ product[0] }}"
                                                   value="{{ product[19] }}" aria-label="">
                                        </div>
                                        <div class="col">
                                            <input type="number" class="form-control"
                                                   name="price_low_amount_{{ product[0] }}"
                                                   value="{{ product[12] }}" aria-label="" tabindex="-1">
                                        </div>
                                        <div class="col">
                                            <input type="number" class="form-control"
                                                   name="amount_medium_{{ product[0] }}"
                                                   value="0" aria-label="">
                                        </div>
                                        <div class="col">
                                            <input type="number" class="form-control"
                                                   name="price_medium_amount_{{ product[0] }}"
                                                   value="{{ product[14] }}" aria-label="" tabindex="-1">
                                        </div>
                                        <div class="col">
                                            <input type="number" class="form-control"
                                                   name="amount_high_{{ product[0] }}"
                                                   value="0" aria-label="">
                                        </div>
                                        <div class="col">
                                            <input type="number" class="form-control"
                                                   name="price_high_amount_{{ product[0] }}"
                                                   value="{{ product[16] }}" aria-label="" tabindex="-1">
                                        </div>
                                    </div>
                                    <hr>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary" name="change_products_report"
                                value="">Change products
                        </button>
                        <button type="submit" class="btn btn-primary" name="add_financial_report"
                                value="">Add Financial Report
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="modal fade" id="addFinancialReportSimplified" tabindex="-1"
         aria-labelledby="addFinancialReportSimplifiedLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addFinancialReportSimplifiedLabel">Add Sales</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"></span>
                    </button>
                </div>
                <form method="post" action="/financial_plan">
                    <div class="modal-body">
                        <button class="btn btn-warning" id="period-toggle-sales-simplified-btn" type="button">MONTH
                        </button>
                        <label for="date_sales" class="form-label">Date</label>
                        <input type="date" class="form-control" id="date_sales" name="date">
                        <div class="row">
                            <div class="col">제품</div>
                            <div class="col">LA</div>
                            <div class="col">LP</div>
                        </div>
                        <div class="sale-toggle-table-simplified">
                            {% for product in data['products'] %}
                                {% if product[7] %}
                                    <div class="row">
                                        <div class="col">
                                            <span>{{ product[1] }}</span>
                                            <input class="form-control" name="{{ product[0] }}" aria-label="" hidden>
                                        </div>
                                        <div class="col">
                                            <input type="number" class="form-control period-toggle-sales-simplified"
                                                   name="amount_low_{{ product[0] }}"
                                                   value="{{ product[19] }}" aria-label="">
                                        </div>
                                        <div class="col">
                                            <input type="number" class="form-control"
                                                   name="price_low_amount_{{ product[0] }}"
                                                   value="{{ product[12] }}" aria-label="" tabindex="-1">
                                        </div>
                                    </div>
                                    <hr>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary" name="add_financial_report_simplified"
                                value="">Add Simplified Financial Report
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="modal fade" id="addLossReport" tabindex="-1"
         aria-labelledby="addLossReportLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addLossReportLabel">Add Loss</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"></span>
                    </button>
                </div>
                <form method="post" action="/financial_plan">
                    <div class="modal-body">
                        <label for="date_loss" class="form-label">Date</label>
                        <input type="date" class="form-control" id="date_loss" name="date">
                        <div class="row">
                            <div class="col">제품</div>
                            <div class="col">Amount</div>
                            <div class="col">Variable Cost</div>
                        </div>
                        {% for product in data['products'] %}
                            {% if product[7] %}
                                <div class="row">
                                    <div class="col">
                                        <span>{{ product[1] }}</span>
                                        <input class="form-control" name="{{ product[0] }}" aria-label="" hidden>
                                    </div>
                                    <div class="col">
                                        <input type="number" class="form-control period-toggle-sales"
                                               name="amount$$${{ product[0] }}"
                                               value="0" aria-label="">
                                    </div>
                                    <div class="col">
                                        <input type="number" class="form-control"
                                               name="price_low_amount$$${{ product[0] }}"
                                               value="{{ data['variable-costs'][product[0]] }}" aria-label="" tabindex="-1">
                                    </div>
                                </div>
                                <hr>
                            {% endif %}
                        {% endfor %}
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

                        <button type="submit" class="btn btn-primary" name="add_loss_report"
                                value="">Add Loss Report
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    {% for sale_date in data['sales'] %}
        <div class="modal fade" id="editModalSale{{ sale_date }}" tabindex="-1"
             aria-labelledby="editModalSaleLabel{{ sale_date }}"
             aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editModalSaleLabel{{ sale_date }}">{{ sale_date }}</h5>
                    </div>
                    <div class="modal-body modal-body-scrollable">
                        <table class="table table-striped table-hover sales-table">
                            <thead>
                            <tr class="keep-all">
                                <th scope="col">DEL</th>
                                <th scope="col">id</th>
                                <th scope="col">date</th>
                                <th scope="col">LQ</th>
                                <th scope="col">LP</th>
                                <th scope="col">MQ</th>
                                <th scope="col">MP</th>
                                <th scope="col">HQ</th>
                                <th scope="col">HP</th>
                                <th scope="col">Pid</th>
                                <th scope="col">VC</th>
                                <th scope="col">TI</th>
                                <th scope="col">VAT</th>
                                <th scope="col">BE</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for row in data['sales'][sale_date] %}
                                <tr class="table-success">
                                    <td>
                                        <button class="btn btn-danger" type="button"
                                                data-bs-toggle="modal"
                                                data-bs-target="#deleteModalSale{{ row[0] }}">
                                            <i class="bi bi-trash-fill"></i>
                                        </button>
                                    </td>

                                    <td class="">{{ row[0] }}</td>
                                    <td class="">{{ row[1] }}</td>
                                    <td class="">{{ row[2] }}</td>
                                    <td class="">{{ row[3] }}</td>
                                    <td class="">{{ row[4] }}</td>
                                    <td class="">{{ row[5] }}</td>
                                    <td class="">{{ row[6] }}</td>
                                    <td class="">{{ row[7] }}</td>
                                    <td class="">{{ row[8] }}</td>
                                    <td class="variable-cost-per-sale">{{ row [9] }}</td>
                                    <td class="income-per-sale">{{ row [10] }}</td>
                                    <td class="vat-per-sale">{{ row[11] }}</td>
                                    <td class="breakeven-per-sale"></td>

                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
    {% for sale_date in data['sales_summary'] %}
        <div class="modal fade" id="deleteModalSaleSummary{{ sale_date }}" tabindex="-1"
             aria-labelledby="deleteModalSaleSummaryLabel{{ sale_date }}"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalFixedCostLabel{{ sale_date }}">
                            DELETE ALL PRODUCTS FOR {{ sale_date }}?</h5>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancal</button>
                        <form action="/financial_plan" method="post">
                            <button class="btn btn-danger" name="btn_delete_sale_summary" value="{{ sale_date }}"
                                    type="submit"><i class="bi bi-trash-fill"></i>DELETE
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
    {% for row in data['all_sales'] %}
        <div class="modal fade" id="deleteModalSale{{ row[0] }}" tabindex="-1"
             aria-labelledby="deleteModalSaleLabel{{ row[0] }}"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalSaleLabel{{ row[0] }}">
                            DELETE SALE: {{ row[0] }} on {{ row[1] }}?</h5>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancal</button>
                        <form action="/financial_plan" method="post">
                            <button class="btn btn-danger" name="btn_delete_sale" value="{{ row[0] }}"
                                    type="submit"><i class="bi bi-trash-fill"></i>DELETE
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
{% endblock %}
{% block endbody %}
    <script src="/static/js/admin.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const ctx = document.getElementById('myChart').getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                datasets: [{
                    label: '# of Votes',
                    data: [12, 19, 3, 5, 2, 3], // Data on Y axis
                    borderWidth: 1,
                    fill: false,
                    borderColor: 'rgb(75, 192, 192)',
                    tension: 0.1
                }]
            }
        });
    </script>

{% endblock %}


